{% extends 'base2.html' %}
{% load static %}


<meta name="viewport" content="width=device-width, initial-scale=1">


{% block title %}
    {{ ticker.name }}
{% endblock %}



{%block extra_head%}

<link rel="stylesheet" href="/static/paper_trade/ticker_page_style.css">
<script src="https://kit.fontawesome.com/275fbb9899.js" crossorigin="anonymous"></script>

{% endblock%}


{% block content %}
    <div>



        

        
        <p  id = "symbol"><span id = "_symbol">symbol: </span>{{ ticker.symbol }} </span>
        <br>
        <img src="/static/paper_trade/ticker_page_images/GBPUSD.jpg" width="200" , height="100" >
        <br>
        <br>
        <p  id = "Bid_Ask"> Bid Price : {{ ticker.bid }}&ensp;&ensp;/&ensp;&ensp; Ask Price : {{ ticker.ask }} </span>
              
        <p  id = "Margin">Free Margin : {{ user.profile.free_margin |floatformat:2 }} USD </p>
        <br>
        

        <h1>
            {{ state_open_order_status }}
        </h1>
        <!-- Open-->

    <!-- <form method="post">
        {% csrf_token %}
        {{ order_open_position_form.as_p }}
        <button name="open_order" type="submit">Place Order</button>
    </form> -->


    <div class="container">

        

        <form  method="POST">
            {% csrf_token %}

          <div class="form-group">
            <label for="input_price">Price:</label>
            <input type="number" class="form-control" id="email" placeholder="Enter Price" name="input_price">
          </div>
          <div class="form-group">
            <label for="initial_quantity">Quantity:</label>
            <input type="number" class="form-control" id="pwd" placeholder="Enter Quantity" name="initial_quantity">
          </div>
      
      
          <label class="radio-inline"><input type="radio" name="direction" checked>Buy</label>
          <label class="radio-inline"><input type="radio" name="direction" >Sell</label>
      
          <div class="form-group" class="col-xs-2">

            
          
              <label for="leverage">Leverage:</label>
              <select class="form-control" id="sel1" , name="leverage">

                {% for leverage in order_open_position_form.leverage %}
                <option>{{leverage}}</option>
                
                {% endfor %}
          
              </select>
            </div>

      
      
      
            <div class="form-group">
              <label for="take_profit">Take Profit:</label>
              <input type="number" class="form-control" id="email" placeholder="Enter Take Profit" name="take_profit">
            </div>
      
      
      
            <div class="form-group">
              <label for="stop_loss">Stop Loss:</label>
              <input type="number" class="form-control" id="email" placeholder="Enter Stop Loss" name="stop_loss">
            </div>
      
          <div class="form-group">
              <label for="signal_text">Signal Text:</label>
              <textarea class="form-control" rows="5" id="comment" name="signal_text"></textarea>
          </div>
          
          <button name="open_order" type="submit" class="btn btn-default btn-lg">Place Order</button>
        </form>
      </div>









        <!-- Open Positions-->
        <h1>
            Your Open Positions:
        </h1>

    {% for open_position in open_positions %}
    {{ open_position }}
        <br>
    {% endfor %}

        <br>
        <h1>
            {{ state_close_order_status }}
        </h1>

        <form method="POST">               
        {% csrf_token %}

        <div class="form-group">
            <label for="input_price">Price:</label>
            <input type="number" class="form-control" id="email" placeholder="Enter Price" name="input_price">
          </div>
          <div class="form-group">
            <label for="quantity">Quantity:</label>
            <input type="number" class="form-control" id="pwd" placeholder="Enter Quantity" name="quantity">
          </div>

          <div class="form-group">
            <label for="open_position_id">Open Position id:</label>
            <input type="number" class="form-control" id="pwd" placeholder="Enter Open Position id" name="open_position_id">
          </div>





          <button name="close_order" type="submit" class="btn btn-default btn-lg">Close Order</button>



        </form>

        <!-- <form method="post">
            {% csrf_token %}
            {{ order_close_position_form.as_p }}
            <button name="close_order" type="submit">Close Position</button>
        </form> -->



        <h1>
            All published posts about {{ ticker.name }}

        </h1>

        <div>
            {% for post in all_posts %}
                <p>
                    Username : {{ post.user.username }}
                </p>
                <p>
                    Date : {{ post.created_datetime }}
                </p>
                <p>
                    Bid price at the moment of publish : {{ post.related_symbol.bid }}
                </p><p>
                Ask price at the moment of publish : {{ post.related_symbol.ask }}
            </p>
                <p>
                    Text : <span class = "TG"> {{ post.text_content }} </span>
                </p>
                <p>
                    Number of Likes : {{ post.number_of_likes }} <i class="fa fa-heart"  style="font-size: 25px; color: red;"></i>

                </p>

                {% if user in post.like_related_users %}
                    <a href="/unlike/{{ post.id }}">Liked</a>
                {% else %}
                    <a href="/like/{{ post.id }}">Like</a>
                {% endif %}
                <br>
            {% endfor %}

        </div>

        <h1>
            {{ state_post_status }}
        </h1>

        <!-- <form method="post">
            {% csrf_token %}
            {{ post_form.as_p }}
            <button name="post" type="submit">Post</button>
        </form> -->



        <form method="POST"  enctype="multipart/form-data" >
            <!-- {% csrf_token %}
            {{ post_form.as_p }}
            <button type="submit">Publish</button> -->
            {% csrf_token %}
    
    
            <div class="form-group">
                <label for="comment">Your Thoughts:</label>
                <textarea class="form-control" rows="5" name="text_content" id="comment"></textarea>
                <button   name ="post" type="submit" class="btn btn-default btn-lg">Publish</button>
    
            </div>
    
    
    
        </form>



    </div>

{% endblock %}
{% block extra_scripts %}
    <script src="{% static 'paper_trade/datatable.js' %}"></script>
    <script src="{% static 'paper_trade/ticker_page.js' %}"></script>
{% endblock %}